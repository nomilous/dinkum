// Generated by CoffeeScript 1.6.3
var defers, extend, queue, _ref;

_ref = require('../support'), extend = _ref.extend, defers = _ref.defers;

queue = void 0;

exports.testable = function() {
  return queue;
};

exports.queue = function(config) {
  var api;
  queue = {
    sequence: 0,
    pending: {
      count: 0,
      items: {}
    },
    active: {
      count: 0,
      items: {}
    },
    enqueue: defers(function(promised, object) {
      queue.pending.items[(++queue.sequence).toString()] = {
        object: object
      };
      queue.pending.count++;
      return promised.resolve();
    }),
    dequeue: function() {
      var seq, _results;
      _results = [];
      for (seq in queue.pending.items) {
        queue.active.items[seq] = queue.pending.items[seq];
        delete queue.pending.items[seq];
        queue.active.count++;
        queue.pending.count--;
        break;
      }
      return _results;
    }
  };
  return api = {
    enqueue: queue.enqueue,
    dequeue: queue.dequeue
  };
};
